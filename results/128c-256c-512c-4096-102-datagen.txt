/home/marco/anaconda/envs/ini_caltech101/bin/python2.7 /home/marco/PycharmProjects/ini_caltech101/caltech101_cnn.py
Using gpu device 0: GeForce GTX 970 (CNMeM is disabled)
Loading data...
X_train shape: (2550, 3, 180, 240)
2550 train samples
306 test samples
Compiling model...
Using real time data augmentation
----------------------------------------
Epoch 0
----------------------------------------
Training...
2550/2550 [==============================] - 322s - loss: 9.9843 - acc: 0.0278
Testing...
306/306 [==============================] - 34s - test loss: 4.3483 - test acc: 0.0490
----------------------------------------
Epoch 1
----------------------------------------
Training...
2550/2550 [==============================] - 318s - loss: 9.3196 - acc: 0.0631
Testing...
306/306 [==============================] - 34s - test loss: 4.0888 - test acc: 0.0850
----------------------------------------
Epoch 2
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 8.9331 - acc: 0.1196
Testing...
306/306 [==============================] - 34s - test loss: 3.8276 - test acc: 0.1503
----------------------------------------
Epoch 3
----------------------------------------
Training...
2550/2550 [==============================] - 319s - loss: 8.5864 - acc: 0.1867
Testing...
306/306 [==============================] - 35s - test loss: 3.5938 - test acc: 0.1830
----------------------------------------
Epoch 4
----------------------------------------
Training...
2550/2550 [==============================] - 322s - loss: 8.2467 - acc: 0.2380
Testing...
306/306 [==============================] - 34s - test loss: 3.4720 - test acc: 0.2484
----------------------------------------
Epoch 5
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 8.0488 - acc: 0.2580
Testing...
306/306 [==============================] - 34s - test loss: 3.4525 - test acc: 0.2516
----------------------------------------
Epoch 6
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 7.8036 - acc: 0.2937
Testing...
306/306 [==============================] - 34s - test loss: 3.5033 - test acc: 0.2059
----------------------------------------
Epoch 7
----------------------------------------
Training...
2550/2550 [==============================] - 322s - loss: 7.6150 - acc: 0.3322
Testing...
306/306 [==============================] - 34s - test loss: 3.4249 - test acc: 0.2582
----------------------------------------
Epoch 8
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 7.4342 - acc: 0.3820
Testing...
306/306 [==============================] - 34s - test loss: 3.4087 - test acc: 0.2647
----------------------------------------
Epoch 9
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 7.2552 - acc: 0.3941
Testing...
306/306 [==============================] - 34s - test loss: 3.4652 - test acc: 0.2843
----------------------------------------
Epoch 10
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 7.0405 - acc: 0.4392
Testing...
306/306 [==============================] - 34s - test loss: 3.2626 - test acc: 0.2778
----------------------------------------
Epoch 11
----------------------------------------
Training...
2550/2550 [==============================] - 323s - loss: 6.9712 - acc: 0.4514
Testing...
306/306 [==============================] - 34s - test loss: 3.3575 - test acc: 0.2941
----------------------------------------
Epoch 12
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 6.8270 - acc: 0.4737
Testing...
306/306 [==============================] - 34s - test loss: 3.3580 - test acc: 0.3039
----------------------------------------
Epoch 13
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 6.7123 - acc: 0.4961
Testing...
306/306 [==============================] - 34s - test loss: 3.5473 - test acc: 0.2843
----------------------------------------
Epoch 14
----------------------------------------
Training...
2550/2550 [==============================] - 321s - loss: 6.4683 - acc: 0.5396
Testing...
306/306 [==============================] - 34s - test loss: 3.4555 - test acc: 0.3105
----------------------------------------
Epoch 15
----------------------------------------
Training...
2550/2550 [==============================] - 318s - loss: 6.4025 - acc: 0.5710
Testing...
306/306 [==============================] - 34s - test loss: 3.5552 - test acc: 0.2843
----------------------------------------
Epoch 16
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 6.2980 - acc: 0.5945
Testing...
306/306 [==============================] - 35s - test loss: 3.5058 - test acc: 0.3007
----------------------------------------
Epoch 17
----------------------------------------
Training...
2550/2550 [==============================] - 323s - loss: 6.1363 - acc: 0.6278
Testing...
306/306 [==============================] - 34s - test loss: 3.6543 - test acc: 0.3203
----------------------------------------
Epoch 18
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 6.0402 - acc: 0.6467
Testing...
306/306 [==============================] - 34s - test loss: 3.5498 - test acc: 0.3268
----------------------------------------
Epoch 19
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.9316 - acc: 0.6655
Testing...
306/306 [==============================] - 34s - test loss: 3.6657 - test acc: 0.3072
----------------------------------------
Epoch 20
----------------------------------------
Training...
2550/2550 [==============================] - 319s - loss: 5.8873 - acc: 0.6808
Testing...
306/306 [==============================] - 34s - test loss: 3.4801 - test acc: 0.3301
----------------------------------------
Epoch 21
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 5.8192 - acc: 0.6957
Testing...
306/306 [==============================] - 35s - test loss: 3.9429 - test acc: 0.3072
----------------------------------------
Epoch 22
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.6820 - acc: 0.7188
Testing...
306/306 [==============================] - 34s - test loss: 3.8317 - test acc: 0.3366
----------------------------------------
Epoch 23
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.6476 - acc: 0.7361
Testing...
306/306 [==============================] - 34s - test loss: 3.5038 - test acc: 0.3595
----------------------------------------
Epoch 24
----------------------------------------
Training...
2550/2550 [==============================] - 321s - loss: 5.6242 - acc: 0.7412
Testing...
306/306 [==============================] - 34s - test loss: 3.5010 - test acc: 0.3627
----------------------------------------
Epoch 25
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.5015 - acc: 0.7541
Testing...
306/306 [==============================] - 34s - test loss: 3.8564 - test acc: 0.3627
----------------------------------------
Epoch 26
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.4484 - acc: 0.7639
Testing...
306/306 [==============================] - 34s - test loss: 3.6720 - test acc: 0.3562
----------------------------------------
Epoch 27
----------------------------------------
Training...
2550/2550 [==============================] - 322s - loss: 5.3961 - acc: 0.7847
Testing...
306/306 [==============================] - 34s - test loss: 3.5445 - test acc: 0.3824
----------------------------------------
Epoch 28
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.2719 - acc: 0.8149
Testing...
306/306 [==============================] - 34s - test loss: 3.8042 - test acc: 0.3595
----------------------------------------
Epoch 29
----------------------------------------
Training...
2550/2550 [==============================] - 319s - loss: 5.2131 - acc: 0.8184
Testing...
306/306 [==============================] - 34s - test loss: 3.5907 - test acc: 0.3987
----------------------------------------
Epoch 30
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 5.2127 - acc: 0.8212
Testing...
306/306 [==============================] - 34s - test loss: 3.4728 - test acc: 0.3856
----------------------------------------
Epoch 31
----------------------------------------
Training...
2550/2550 [==============================] - 321s - loss: 5.1607 - acc: 0.8259
Testing...
306/306 [==============================] - 34s - test loss: 3.7550 - test acc: 0.3660
----------------------------------------
Epoch 32
----------------------------------------
Training...
2550/2550 [==============================] - 318s - loss: 5.1253 - acc: 0.8333
Testing...
306/306 [==============================] - 34s - test loss: 3.7176 - test acc: 0.3562
----------------------------------------
Epoch 33
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 5.0784 - acc: 0.8463
Testing...
306/306 [==============================] - 34s - test loss: 3.9881 - test acc: 0.3301
----------------------------------------
Epoch 34
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 5.0239 - acc: 0.8490
Testing...
306/306 [==============================] - 34s - test loss: 3.8570 - test acc: 0.3562
----------------------------------------
Epoch 35
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 4.9790 - acc: 0.8663
Testing...
306/306 [==============================] - 34s - test loss: 3.7129 - test acc: 0.3660
----------------------------------------
Epoch 36
----------------------------------------
Training...
2550/2550 [==============================] - 318s - loss: 4.9583 - acc: 0.8675
Testing...
306/306 [==============================] - 34s - test loss: 3.7715 - test acc: 0.3725
----------------------------------------
Epoch 37
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 4.9381 - acc: 0.8608
Testing...
306/306 [==============================] - 34s - test loss: 3.9042 - test acc: 0.3627
----------------------------------------
Epoch 38
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 4.8746 - acc: 0.8804
Testing...
306/306 [==============================] - 34s - test loss: 3.8719 - test acc: 0.3791
----------------------------------------
Epoch 39
----------------------------------------
Training...
2550/2550 [==============================] - 316s - loss: 4.8069 - acc: 0.8882
Testing...
306/306 [==============================] - 34s - test loss: 4.0985 - test acc: 0.3529
----------------------------------------
Epoch 40
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 4.7996 - acc: 0.8969
Testing...
306/306 [==============================] - 34s - test loss: 3.7899 - test acc: 0.3562
----------------------------------------
Epoch 41
----------------------------------------
Training...
2550/2550 [==============================] - 319s - loss: 4.8022 - acc: 0.8902
Testing...
306/306 [==============================] - 34s - test loss: 3.8714 - test acc: 0.3366
----------------------------------------
Epoch 42
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 4.8137 - acc: 0.8796
Testing...
306/306 [==============================] - 34s - test loss: 3.7597 - test acc: 0.3758
----------------------------------------
Epoch 43
----------------------------------------
Training...
2550/2550 [==============================] - 317s - loss: 4.7435 - acc: 0.8898
Testing...
306/306 [==============================] - 34s - test loss: 3.7686 - test acc: 0.3954
----------------------------------------
Epoch 44
----------------------------------------
Training...
 768/2550 [========>.....................] - ETA: 223s - loss: 4.7064 - acc: 0.9023